---
title     : 'Dameng'
summary   : 'Collect dameng database metrics'
tags:
  - 'DATA STORES'
__int_icon      : 'icon/dameng'
dashboard :
  - desc  : 'Dameng'
    path  : 'dashboard/en/dameng'
monitor   :
  - desc  : 'N/A'
    path  : '-'
---


{{.AvailableArchs}}

---

Dameng collector can collect the running status index from Dameng database instance.

### Collector Configuration {#input-config}

<!-- markdownlint-disable MD046 -->
=== "Host Installation"

    Go to the `conf.d/{{.Catalog}}` directory under the DataKit installation directory, copy `{{.InputName}}.conf.sample` and name it `{{.InputName}}.conf`. Examples are as follows:

    ```toml
    {{ CodeBlock .InputSample 4 }}
    ```

    After configuration, [restart DataKit](../datakit/datakit-service-how-to.md#manage-service).

=== "Kubernetes"

    The collector can now be turned on by [ConfigMap Injection Collector Configuration](../datakit/datakit-daemonset-deploy.md#configmap-setting).
<!-- markdownlint-enable -->

## Metric {#metric}

For all of the following data collections, the global election tags will added automatically, we can add extra tags in `[inputs.{{.InputName}}.tags]` if needed:

{{ range $i, $m := .Measurements }}
{{if eq $m.Type "metric"}}

### `{{$m.Name}}`

- Tags

{{$m.TagsMarkdownTable}}

- Metrics

{{$m.FieldsMarkdownTable}}

{{ end }}
{{ end }}

## Log Collection {#logging}

- During the operation of the Dameng database, some critical information is recorded in log files located in the `log` directory under the installation directory, with the naming format `dm_<instance name>_YYYYMM.log`. For example: `dm_DMSERVER_202507.log`.

- The Dameng collector does not have log collection enabled by default. You can open `files` in *conf.d/{{.Catalog}}/{{.InputName}}.conf*  and write to the absolute path of the Dameng log file. For example:

```toml
[[inputs.dameng]]

  ...

  [inputs.dameng.log]
    files = ["/home/dmdba/dmdbms/log/dm_DMSERVER_202507.log"]
```

When log collection is turned on, a log with a log `source` of `dameng` is generated by default.

**Notices:**

- Log collection only supports logs on hosts where DataKit is installed.

### Log Pipeline Cut {#pipeline}

The original log is

``` log
2025-07-03 10:16:20.659 [INFO] database P0000001485 T0000000000000001485  INI parameter ROLLSEG_POOLS changed, the original value 19, new value 1
```

Description of the cut field:

| Field name         | Field Value                                                      | Description                                                    |
| ---                | ---                                                              | ---                                                            |
| `msg`              | `database P0000001485 T0000000000000001485  …… new value 1`   | Log content                                                    |
| `status`           | `info`                                                          | Current log level (ERROR,FATAL,WARNING,INFO)  |
| `time`             | `1751537780`                                            | Log generation time                                            |
