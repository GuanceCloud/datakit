# /conf/master-tls.conf
# Redis Master - TLS 配置

# 网络配置
bind 192.168.139.162
# 禁用非 TLS 端口
port 0
tls-port 6379

# 通用配置
pidfile /var/run/redis_6379.pid

# 持久化配置
dir /data
dbfilename dump-master-tls.rdb
appendonly yes

# 内存配置
maxmemory 500mb
maxmemory-policy allkeys-lfu

# 安全配置
requirepass abc123456
masterauth abc123456

# 慢查询日志
slowlog-log-slower-than 5000
slowlog-max-len 1024

# ====== TLS 配置 ======
# CA 证书
tls-ca-cert-file /tls/ca-cert.pem

# 服务器证书和私钥
tls-cert-file /tls/redis-server-cert.pem
tls-key-file /tls/redis-server-key.pem

# 客户端认证模式（包括从节点和哨兵）
tls-auth-clients no

# 主从复制使用 TLS
tls-replication yes

# 支持的 TLS 协议版本
tls-protocols "TLSv1.2 TLSv1.3"

# 优先使用服务器端的密码套件
tls-prefer-server-ciphers yes

# TLS 会话缓存
tls-session-caching yes
tls-session-cache-size 20480
tls-session-cache-timeout 300

